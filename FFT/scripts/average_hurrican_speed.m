clear;
close all;
clc;

% http://www.aoml.noaa.gov/hrd/tcfaq/G16.html

% Each row represents a bin where each bin range increments
% by 5. For example, bin 1 = 0 to 5 deg, bin 2 = 5 to
% 10 deg, bin 3 = 10 to 15 deg, etc.
% col 1: Average forward speed in mph of cases in this bin
% col 2: Number of cases in this latitude bin
obs = [...
    16.1 186;...
    13.7 4678;...
    11.9 7620;...
    10.8 7501;...
    10.8 8602;...
    12.5 6469;...
    16.9 3397;...
    24.2 1120;...
    30.6 264;...
    32 34;...
    32 15;...
    34.7 1];

% Observations with speeds converted to m/s
obs = [convvel(obs(:,1), 'mph', 'm/s') obs(:,2)];
avg_speed = sum(obs(:,1).*obs(:,2))/sum(obs(:,2))
avg_speed_mph = convvel(avg_speed, 'm/s', 'mph')

d = 3000;
t = d/avg_speed  % seconds for avg cloud to travel d meters